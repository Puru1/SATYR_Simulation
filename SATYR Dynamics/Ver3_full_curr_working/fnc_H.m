function [H] = fnc_H(q,L,vMass)

H = zeros(4,4);

  H(1,1)=vMass(2) + vMass(3) + vMass(4) + vMass(1) + 3/(4000*L(4)^2);
  H(1,2)=vMass(3)*((9*L(2)*cos(q(2) + q(3)))/10 + L(1)*cos(q(2))) + vMass(4)*((7329*cos(q(2) +...
          q(3) + q(4)))/100000 + (471*sin(q(2) + q(3) + q(4)))/25000 + L(2)*cos(q(2) + q(3)) + L(1)*cos(q(2))) +...
          (2169*L(1)*vMass(2)*cos(q(2)))/10000;
  H(1,3)=vMass(4)*((7329*cos(q(2) + q(3) + q(4)))/100000 + (471*sin(q(2) + q(3) + q(4)))/25000 +...
          L(2)*cos(q(2) + q(3))) + (9*L(2)*vMass(3)*cos(q(2) + q(3)))/10;
  H(1,4)=vMass(4)*((7329*cos(q(2) + q(3) + q(4)))/100000 + (471*sin(q(2) + q(3) + q(4)))/25000);
  H(2,1)=vMass(3)*((9*L(2)*cos(q(2) + q(3)))/10 + L(1)*cos(q(2))) + vMass(4)*((7329*cos(q(2) +...
          q(3) + q(4)))/100000 + (471*sin(q(2) + q(3) + q(4)))/25000 + L(2)*cos(q(2) + q(3)) + L(1)*cos(q(2))) +...
          (2169*L(1)*vMass(2)*cos(q(2)))/10000;
  H(2,2)=vMass(3)*((9*L(2)*cos(q(2) + q(3)))/10 + L(1)*cos(q(2)))^2 + vMass(4)*((7329*cos(q(2) +...
          q(3) + q(4)))/100000 + (471*sin(q(2) + q(3) + q(4)))/25000 + L(2)*cos(q(2) + q(3)) + L(1)*cos(q(2)))^2 +...
          vMass(3)*((9*L(2)*sin(q(2) + q(3)))/10 + L(1)*sin(q(2)))^2 + vMass(4)*((7329*sin(q(2) + q(3) +...
          q(4)))/100000 - (471*cos(q(2) + q(3) + q(4)))/25000 + L(2)*sin(q(2) + q(3)) + L(1)*sin(q(2)))^2 + (4704561*L(1)^2*...
         vMass(2)*cos(q(2))^2)/100000000 + (4704561*L(1)^2*vMass(2)*sin(q(2))^2)/100000000 + 2683/12500;
  H(2,3)=vMass(4)*((7329*sin(q(2) + q(3) + q(4)))/100000 - (471*cos(q(2) + q(3) + q(4)))/25000 +...
          L(2)*sin(q(2) + q(3)))*((7329*sin(q(2) + q(3) + q(4)))/100000 - (471*cos(q(2) + q(3) + q(4)))/25000 +...
          L(2)*sin(q(2) + q(3)) + L(1)*sin(q(2))) + vMass(4)*((7329*cos(q(2) + q(3) + q(4)))/100000 + (471*...
         sin(q(2) + q(3) + q(4)))/25000 + L(2)*cos(q(2) + q(3)))*((7329*cos(q(2) + q(3) + q(4)))/100000 + (471*...
         sin(q(2) + q(3) + q(4)))/25000 + L(2)*cos(q(2) + q(3)) + L(1)*cos(q(2))) + (9*L(2)*vMass(3)*sin(q(2) + q(3))*...
         ((9*L(2)*sin(q(2) + q(3)))/10 + L(1)*sin(q(2))))/10 + (9*L(2)*vMass(3)*cos(q(2) + q(3))*((9*L(2)*...
         cos(q(2) + q(3)))/10 + L(1)*cos(q(2))))/10 + 10107/50000;
  H(2,4)=vMass(4)*((7329*cos(q(2) + q(3) + q(4)))/100000 + (471*sin(q(2) + q(3) + q(4)))/25000)*...
         ((7329*cos(q(2) + q(3) + q(4)))/100000 + (471*sin(q(2) + q(3) + q(4)))/25000 + L(2)*cos(q(2) + q(3)) +...
          L(1)*cos(q(2))) - vMass(4)*((471*cos(q(2) + q(3) + q(4)))/25000 - (7329*sin(q(2) + q(3) + q(4)))/100000)*...
         ((7329*sin(q(2) + q(3) + q(4)))/100000 - (471*cos(q(2) + q(3) + q(4)))/25000 + L(2)*sin(q(2) + q(3)) +...
          L(1)*sin(q(2))) + 4933/25000;
  H(3,1)=vMass(4)*((7329*cos(q(2) + q(3) + q(4)))/100000 + (471*sin(q(2) + q(3) + q(4)))/25000 +...
          L(2)*cos(q(2) + q(3))) + (9*L(2)*vMass(3)*cos(q(2) + q(3)))/10;
  H(3,2)=vMass(4)*((7329*sin(q(2) + q(3) + q(4)))/100000 - (471*cos(q(2) + q(3) + q(4)))/25000 +...
          L(2)*sin(q(2) + q(3)))*((7329*sin(q(2) + q(3) + q(4)))/100000 - (471*cos(q(2) + q(3) + q(4)))/25000 +...
          L(2)*sin(q(2) + q(3)) + L(1)*sin(q(2))) + vMass(4)*((7329*cos(q(2) + q(3) + q(4)))/100000 + (471*...
         sin(q(2) + q(3) + q(4)))/25000 + L(2)*cos(q(2) + q(3)))*((7329*cos(q(2) + q(3) + q(4)))/100000 + (471*...
         sin(q(2) + q(3) + q(4)))/25000 + L(2)*cos(q(2) + q(3)) + L(1)*cos(q(2))) + (9*L(2)*vMass(3)*sin(q(2) + q(3))*...
         ((9*L(2)*sin(q(2) + q(3)))/10 + L(1)*sin(q(2))))/10 + (9*L(2)*vMass(3)*cos(q(2) + q(3))*((9*L(2)*...
         cos(q(2) + q(3)))/10 + L(1)*cos(q(2))))/10 + 10107/50000;
  H(3,3)=vMass(4)*((7329*sin(q(2) + q(3) + q(4)))/100000 - (471*cos(q(2) + q(3) + q(4)))/25000 +...
          L(2)*sin(q(2) + q(3)))^2 + vMass(4)*((7329*cos(q(2) + q(3) + q(4)))/100000 + (471*sin(q(2) + q(3) +...
          q(4)))/25000 + L(2)*cos(q(2) + q(3)))^2 + (81*L(2)^2*vMass(3)*cos(q(2) + q(3))^2)/100 + (81*L(2)^2*vMass(3)*...
         sin(q(2) + q(3))^2)/100 + 10107/50000;
  H(3,4)=vMass(4)*((7329*cos(q(2) + q(3) + q(4)))/100000 + (471*sin(q(2) + q(3) + q(4)))/25000)*...
         ((7329*cos(q(2) + q(3) + q(4)))/100000 + (471*sin(q(2) + q(3) + q(4)))/25000 + L(2)*cos(q(2) +...
          q(3))) - vMass(4)*((471*cos(q(2) + q(3) + q(4)))/25000 - (7329*sin(q(2) + q(3) + q(4)))/100000)*((7329*sin(q(2) +...
          q(3) + q(4)))/100000 - (471*cos(q(2) + q(3) + q(4)))/25000 + L(2)*sin(q(2) + q(3))) + 4933/25000;
  H(4,1)=vMass(4)*((7329*cos(q(2) + q(3) + q(4)))/100000 + (471*sin(q(2) + q(3) + q(4)))/25000);
  H(4,2)=vMass(4)*((7329*cos(q(2) + q(3) + q(4)))/100000 + (471*sin(q(2) + q(3) + q(4)))/25000)*...
         ((7329*cos(q(2) + q(3) + q(4)))/100000 + (471*sin(q(2) + q(3) + q(4)))/25000 + L(2)*cos(q(2) + q(3)) +...
          L(1)*cos(q(2))) - vMass(4)*((471*cos(q(2) + q(3) + q(4)))/25000 - (7329*sin(q(2) + q(3) + q(4)))/100000)*...
         ((7329*sin(q(2) + q(3) + q(4)))/100000 - (471*cos(q(2) + q(3) + q(4)))/25000 + L(2)*sin(q(2) + q(3)) +...
          L(1)*sin(q(2))) + 4933/25000;
  H(4,3)=vMass(4)*((7329*cos(q(2) + q(3) + q(4)))/100000 + (471*sin(q(2) + q(3) + q(4)))/25000)*...
         ((7329*cos(q(2) + q(3) + q(4)))/100000 + (471*sin(q(2) + q(3) + q(4)))/25000 + L(2)*cos(q(2) +...
          q(3))) - vMass(4)*((471*cos(q(2) + q(3) + q(4)))/25000 - (7329*sin(q(2) + q(3) + q(4)))/100000)*((7329*sin(q(2) +...
          q(3) + q(4)))/100000 - (471*cos(q(2) + q(3) + q(4)))/25000 + L(2)*sin(q(2) + q(3))) + 4933/25000;
  H(4,4)=vMass(4)*((471*cos(q(2) + q(3) + q(4)))/25000 - (7329*sin(q(2) + q(3) + q(4)))/100000)^2 +...
          vMass(4)*((7329*cos(q(2) + q(3) + q(4)))/100000 + (471*sin(q(2) + q(3) + q(4)))/25000)^2 + 4933/25000;

 